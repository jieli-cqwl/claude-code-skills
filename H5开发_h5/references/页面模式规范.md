# H5 页面模式规范

> 标准化页面结构和开发模式

---

## 一、列表页模式

### 1.1 使用 z-paging

```vue
<template>
  <view class="page-list">
    <z-paging
      ref="pagingRef"
      v-model="list"
      @query="queryList"
    >
      <!-- 筛选栏 -->
      <template #top>
        <comp-dropmenu-new
          :options="filterOptions"
          @change="onFilterChange"
        />
      </template>

      <!-- 列表项 -->
      <view
        v-for="item in list"
        :key="item.id"
        class="list-item"
        @tap="goDetail(item.id)"
      >
        <view class="list-item__title">{{ item.name }}</view>
        <view class="list-item__desc">{{ item.description }}</view>
      </view>

      <!-- 空状态 -->
      <template #empty>
        <comp-empty text="暂无数据" />
      </template>
    </z-paging>
  </view>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const pagingRef = ref()
const list = ref<ItemType[]>([])
const filterParams = ref({})

const queryList = async (pageNo: number, pageSize: number) => {
  try {
    const res = await api.getList({
      ...filterParams.value,
      pageNo,
      pageSize
    })
    pagingRef.value?.complete(res.records)
  } catch (error) {
    pagingRef.value?.complete(false)
  }
}

const onFilterChange = (params: FilterParams) => {
  filterParams.value = params
  pagingRef.value?.reload()
}

const goDetail = (id: number) => {
  uni.navigateTo({ url: `/pages/xxx/detail?id=${id}` })
}
</script>

<style lang="scss" scoped>
.page-list {
  min-height: 100vh;
  background: $bgc-page;
}

.list-item {
  padding: 20rpx 32rpx;
  background: $bgc-white;
  margin-bottom: 20rpx;
  border-radius: 8rpx;

  &__title {
    font-size: 32rpx;
    color: $text-black;
    font-weight: 500;
  }

  &__desc {
    font-size: 24rpx;
    color: $text-grey;
    margin-top: 12rpx;
  }
}
</style>
```

---

## 二、表单页模式

### 2.1 使用 comp-form-configure

```vue
<template>
  <view class="page-form">
    <comp-form-configure
      ref="formRef"
      :formItemMap="formItemMap"
      :formModel="formModel"
    />

    <!-- 底部按钮 -->
    <view class="footer-btn safe-area-bottom">
      <button
        class="btn-submit"
        :loading="submitting"
        @tap="handleSubmit"
      >
        提交
      </button>
    </view>
  </view>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'

const formRef = ref()
const submitting = ref(false)

const formModel = reactive({
  name: '',
  phone: '',
  type: ''
})

const formItemMap = {
  name: {
    type: 'input',
    label: '姓名',
    required: true,
    placeholder: '请输入姓名',
    maxlength: 20
  },
  phone: {
    type: 'input',
    label: '手机号',
    required: true,
    placeholder: '请输入手机号',
    inputType: 'number',
    maxlength: 11
  },
  type: {
    type: 'picker',
    label: '类型',
    required: true,
    placeholder: '请选择类型',
    options: [
      { label: '类型A', value: 'A' },
      { label: '类型B', value: 'B' }
    ]
  }
}

const handleSubmit = async () => {
  // 表单验证
  const valid = await formRef.value?.validate()
  if (!valid) return

  submitting.value = true
  try {
    await api.submit(formModel)
    uni.showToast({ title: '提交成功' })
    setTimeout(() => uni.navigateBack(), 1500)
  } catch (error) {
    uni.showToast({ title: '提交失败', icon: 'none' })
  } finally {
    submitting.value = false
  }
}
</script>

<style lang="scss" scoped>
.page-form {
  min-height: 100vh;
  padding-bottom: 120rpx;
  background: $bgc-page;
}

.footer-btn {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 20rpx 32rpx;
  background: $bgc-white;

  .btn-submit {
    width: 100%;
    height: 88rpx;
    background: $bgc-blue;
    color: #fff;
    font-size: 32rpx;
    border-radius: 8rpx;

    &[loading] {
      opacity: 0.7;
    }
  }
}

.safe-area-bottom {
  padding-bottom: calc(20rpx + env(safe-area-inset-bottom));
}
</style>
```

---

## 三、多步骤表单

### 3.1 Pinia 状态管理

```typescript
// stores/checkin.ts
import { defineStore } from 'pinia'

interface CheckinState {
  step: number
  maxStep: number
  basicInfo: BasicInfo
  contractInfo: ContractInfo
  depositInfo: DepositInfo
}

export const useCheckinStore = defineStore('checkin', {
  state: (): CheckinState => ({
    step: 1,
    maxStep: 3,
    basicInfo: {},
    contractInfo: {},
    depositInfo: {}
  }),

  actions: {
    nextStep() {
      if (this.step < this.maxStep) {
        this.step++
      }
    },

    prevStep() {
      if (this.step > 1) {
        this.step--
      }
    },

    saveBasicInfo(data: BasicInfo) {
      this.basicInfo = data
      this.nextStep()
    },

    saveContractInfo(data: ContractInfo) {
      this.contractInfo = data
      this.nextStep()
    },

    reset() {
      this.step = 1
      this.basicInfo = {}
      this.contractInfo = {}
      this.depositInfo = {}
    }
  }
})
```

### 3.2 步骤页面

```vue
<template>
  <view class="page-steps">
    <!-- 步骤指示器 -->
    <view class="steps-indicator">
      <view
        v-for="i in store.maxStep"
        :key="i"
        class="step"
        :class="{ 'is-active': i <= store.step }"
      >
        {{ i }}
      </view>
    </view>

    <!-- 步骤内容 -->
    <view class="steps-content">
      <step-basic v-if="store.step === 1" />
      <step-contract v-else-if="store.step === 2" />
      <step-deposit v-else-if="store.step === 3" />
    </view>
  </view>
</template>

<script setup lang="ts">
import { useCheckinStore } from '@/stores/checkin'

const store = useCheckinStore()

onUnmounted(() => {
  store.reset()
})
</script>
```

---

## 四、详情页模式

```vue
<template>
  <view class="page-detail">
    <!-- 加载中 -->
    <view v-if="loading" class="loading">
      <uni-load-more status="loading" />
    </view>

    <!-- 详情内容 -->
    <template v-else>
      <view class="card">
        <view class="card__title">基本信息</view>
        <view class="info-row">
          <text class="info-row__label">姓名</text>
          <text class="info-row__value">{{ detail.name }}</text>
        </view>
        <view class="info-row">
          <text class="info-row__label">手机号</text>
          <text class="info-row__value">{{ detail.phone }}</text>
        </view>
      </view>

      <!-- 操作按钮 -->
      <view class="footer-btn safe-area-bottom">
        <button class="btn-secondary" @tap="handleEdit">编辑</button>
        <button class="btn-primary" @tap="handleAction">操作</button>
      </view>
    </template>
  </view>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'

const loading = ref(true)
const detail = ref<DetailType>({})

onMounted(async () => {
  const { id } = getCurrentPages().pop()?.options || {}
  if (id) {
    await fetchDetail(id)
  }
})

const fetchDetail = async (id: string) => {
  loading.value = true
  try {
    detail.value = await api.getDetail(id)
  } finally {
    loading.value = false
  }
}
</script>
```

---

## 五、Tab 页面模式

```vue
<template>
  <view class="page-tabs">
    <!-- Tab 栏 -->
    <view class="tabs">
      <view
        v-for="tab in tabs"
        :key="tab.value"
        class="tab-item"
        :class="{ 'is-active': currentTab === tab.value }"
        @tap="currentTab = tab.value"
      >
        {{ tab.label }}
      </view>
    </view>

    <!-- Tab 内容 -->
    <swiper
      :current="currentIndex"
      @change="onSwiperChange"
    >
      <swiper-item v-for="tab in tabs" :key="tab.value">
        <tab-content :type="tab.value" />
      </swiper-item>
    </swiper>
  </view>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'

const tabs = [
  { label: '全部', value: 'all' },
  { label: '待处理', value: 'pending' },
  { label: '已完成', value: 'completed' }
]

const currentTab = ref('all')

const currentIndex = computed(() =>
  tabs.findIndex(t => t.value === currentTab.value)
)

const onSwiperChange = (e: any) => {
  currentTab.value = tabs[e.detail.current].value
}
</script>
```

---

## 六、目录结构

```
pages/
├── tenant/                    # 租客模块
│   ├── list.vue              # 列表页
│   ├── detail.vue            # 详情页
│   └── form.vue              # 表单页
├── checkin/                   # 入住登记模块
│   ├── index.vue             # 入口/步骤容器
│   ├── components/
│   │   ├── step-basic.vue    # 步骤1
│   │   ├── step-contract.vue # 步骤2
│   │   └── step-deposit.vue  # 步骤3
│   └── stores/
│       └── checkin.ts        # 状态管理
└── common/
    └── webview.vue           # 通用 WebView
```
