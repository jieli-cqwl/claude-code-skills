# H5 交互组件规范

> 弹窗、菜单、提示等交互组件使用规范

---

## 一、弹窗组件（comp-popup 系列）

### 1.1 基础弹窗 comp-popup

```vue
<comp-popup
  :visible="showPopup"
  position="bottom"
  :round="true"
  :close-on-click-overlay="true"
  @close="showPopup = false"
>
  <view class="popup-content">
    <!-- 内容 -->
  </view>
</comp-popup>
```

**Props**:
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| visible | boolean | false | 是否显示 |
| position | string | 'bottom' | 弹出位置：top/bottom/center/left/right |
| round | boolean | true | 是否显示圆角 |
| closeOnClickOverlay | boolean | true | 点击遮罩是否关闭 |

### 1.2 提示弹窗 comp-popup-tips

```vue
<comp-popup-tips
  :visible="showTips"
  title="提示"
  content="确定要删除吗？"
  confirmText="确定"
  cancelText="取消"
  @confirm="handleConfirm"
  @cancel="showTips = false"
/>
```

**Props**:
| 属性 | 类型 | 说明 |
|------|------|------|
| title | string | 标题 |
| content | string | 内容 |
| confirmText | string | 确认按钮文字 |
| cancelText | string | 取消按钮文字 |
| showCancel | boolean | 是否显示取消按钮 |

### 1.3 选择器弹窗 comp-popup-picker

```vue
<comp-popup-picker
  :visible="showPicker"
  :options="options"
  :defaultValue="selectedValue"
  @confirm="onPickerConfirm"
  @cancel="showPicker = false"
/>
```

**Props**:
| 属性 | 类型 | 说明 |
|------|------|------|
| options | array | 选项列表 `[{ label, value }]` |
| defaultValue | any | 默认选中值 |
| multiple | boolean | 是否多选 |

---

## 二、下拉菜单（comp-dropmenu-new）

### 2.1 基本用法

```vue
<comp-dropmenu-new
  :options="menuOptions"
  @change="onMenuChange"
/>
```

### 2.2 配置项

```typescript
const menuOptions = [
  {
    key: 'status',
    title: '状态',
    type: 'single', // single/multiple
    options: [
      { label: '全部', value: '' },
      { label: '待处理', value: 'pending' },
      { label: '已完成', value: 'completed' }
    ]
  },
  {
    key: 'time',
    title: '时间',
    type: 'single',
    options: [
      { label: '全部', value: '' },
      { label: '今天', value: 'today' },
      { label: '本周', value: 'week' },
      { label: '本月', value: 'month' }
    ]
  }
]
```

### 2.3 事件处理

```typescript
const onMenuChange = (params: Record<string, any>) => {
  // params: { status: 'pending', time: 'today' }
  filterParams.value = params
  pagingRef.value?.reload()
}
```

---

## 三、消息提示（comp-notice）

### 3.1 Toast 提示

```typescript
// 成功提示
uni.showToast({
  title: '操作成功',
  icon: 'success'
})

// 失败提示
uni.showToast({
  title: '操作失败',
  icon: 'none'
})

// 自定义图标
uni.showToast({
  title: '提示信息',
  icon: 'none',
  image: '/static/icons/warning.png'
})
```

### 3.2 Loading 提示

```typescript
// 显示 loading
uni.showLoading({
  title: '加载中...',
  mask: true
})

// 隐藏 loading
uni.hideLoading()

// 封装用法
const withLoading = async <T>(
  fn: () => Promise<T>,
  title = '加载中...'
): Promise<T> => {
  uni.showLoading({ title, mask: true })
  try {
    return await fn()
  } finally {
    uni.hideLoading()
  }
}

// 使用
const data = await withLoading(() => api.getData())
```

### 3.3 Modal 对话框

```typescript
uni.showModal({
  title: '提示',
  content: '确定要删除吗？',
  confirmText: '确定',
  confirmColor: '#ED184E',
  cancelText: '取消',
  success: (res) => {
    if (res.confirm) {
      handleDelete()
    }
  }
})
```

---

## 四、空状态（comp-empty）

### 4.1 基本用法

```vue
<comp-empty
  v-if="!list.length"
  text="暂无数据"
  :image="emptyImage"
>
  <template #action>
    <button class="btn-action" @tap="handleRefresh">
      刷新试试
    </button>
  </template>
</comp-empty>
```

### 4.2 预设类型

```vue
<!-- 暂无数据 -->
<comp-empty type="data" />

<!-- 网络错误 -->
<comp-empty type="network" @retry="handleRetry" />

<!-- 搜索无结果 -->
<comp-empty type="search" :keyword="keyword" />

<!-- 暂无消息 -->
<comp-empty type="message" />
```

### 4.3 样式规范

```scss
.comp-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 80rpx 32rpx;

  &__image {
    width: 240rpx;
    height: 240rpx;
    margin-bottom: 32rpx;
  }

  &__text {
    font-size: 28rpx;
    color: $text-grey;
    text-align: center;
  }

  &__action {
    margin-top: 32rpx;
  }
}
```

---

## 五、操作反馈规范

### 5.1 操作时机

| 操作 | 反馈方式 | 时机 |
|------|---------|------|
| 点击按钮 | Loading | 立即 |
| 提交表单 | Toast 成功/失败 | API 返回后 |
| 删除数据 | Modal 确认 → Toast | 确认后 |
| 网络错误 | Empty + 重试按钮 | 请求失败 |

### 5.2 按钮 Loading 状态

```vue
<template>
  <button
    class="btn-submit"
    :loading="submitting"
    :disabled="submitting"
    @tap="handleSubmit"
  >
    {{ submitting ? '提交中...' : '提交' }}
  </button>
</template>

<script setup lang="ts">
const submitting = ref(false)

const handleSubmit = async () => {
  if (submitting.value) return

  submitting.value = true
  try {
    await api.submit(formData)
    uni.showToast({ title: '提交成功' })
  } catch (error) {
    uni.showToast({ title: '提交失败', icon: 'none' })
  } finally {
    submitting.value = false
  }
}
</script>
```

---

## 六、动画规范

### 6.1 弹窗动画

```scss
// 底部弹出
.popup-enter {
  transform: translateY(100%);
}
.popup-enter-active {
  transition: transform 0.3s ease-out;
}
.popup-enter-to {
  transform: translateY(0);
}

// 淡入
.fade-enter {
  opacity: 0;
}
.fade-enter-active {
  transition: opacity 0.2s ease;
}
.fade-enter-to {
  opacity: 1;
}
```

### 6.2 动画时长规范

| 类型 | 时长 | 缓动 |
|------|------|------|
| Toast | 200ms | ease |
| 弹窗进入 | 300ms | ease-out |
| 弹窗退出 | 250ms | ease-in |
| 列表项 | 200ms | ease |
| 页面切换 | 300ms | ease |
