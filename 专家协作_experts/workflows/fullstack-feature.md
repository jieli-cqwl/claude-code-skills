# 全栈功能开发工作流

> 适用于需要前后端同步开发的功能

---

## 适用场景

- 新增完整功能（如：用户认证、订单管理）
- 需要 API 设计 + 前端交互
- 涉及数据库变更

---

## 参与专家

| 专家 | 职责 |
|------|------|
| tech-lead | 任务分解、协调整合 |
| backend-architect | API 设计、数据库设计 |
| frontend-architect | 组件设计、交互设计 |
| code-reviewer | 代码审查 |

---

## 执行流程

```
┌─────────────────────────────────────────────────────────────┐
│                    Phase 1: 需求分析                         │
├─────────────────────────────────────────────────────────────┤
│  tech-lead: 分解任务，识别前后端边界                          │
│  输出: 任务清单、接口契约草案                                 │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    Phase 2: 架构设计（并行）                  │
├─────────────────────────────────────────────────────────────┤
│  backend-architect          │  frontend-architect           │
│  - API 设计                 │  - 组件结构设计                │
│  - 数据库 Schema            │  - 状态管理方案                │
│  - 缓存策略                 │  - 交互流程                   │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    Phase 3: 接口对齐                         │
├─────────────────────────────────────────────────────────────┤
│  tech-lead: 确认接口契约                                     │
│  - 请求/响应格式                                             │
│  - 错误码定义                                                │
│  - 字段命名一致性                                            │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    Phase 4: 实现（顺序）                      │
├─────────────────────────────────────────────────────────────┤
│  1. 后端实现（backend-architect 指导）                       │
│  2. 前端实现（frontend-architect 指导）                      │
│  3. 联调验证                                                 │
│                                                             │
│  ⚠️ 实时代码检查（每完成一个文件必须执行）：                   │
│  - 铁律检查: HTTP 状态码、降级、硬编码、类型注解等            │
│  - lint/type 检查: ruff/mypy 或 eslint/tsc                  │
│  - 发现问题立即修复，不允许遗留                              │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    Phase 5: 审查                             │
├─────────────────────────────────────────────────────────────┤
│  code-reviewer: 三阶段审查                                   │
│  - 铁律审查: 7 条编码铁律是否全部遵守                        │
│  - 规范审查: 是否匹配需求                                    │
│  - 质量审查: 代码是否干净                                    │
│                                                             │
│  ❌ 任何铁律违反都必须修复，不允许标记为"建议"或"可选"        │
└─────────────────────────────────────────────────────────────┘
```

---

## 输出物

| 阶段 | 输出 |
|------|------|
| 需求分析 | 任务清单、接口契约草案 |
| 架构设计 | API 文档、数据库 DDL、组件树 |
| 接口对齐 | 最终接口契约 |
| 实现 | 可运行代码、单元测试 |
| 审查 | 审查报告 |

---

## 使用示例

```
用户: /experts 实现用户登录功能

tech-lead 分解任务:
- Task 1: 设计登录 API (backend-architect)
- Task 2: 设计登录页面 (frontend-architect)
- Task 3: 对齐接口契约
- Task 4: 实现后端 API
- Task 5: 实现前端页面
- Task 6: 联调验证
- Task 7: 代码审查 (code-reviewer)
```
