<!-- ARCHIVED: 2026-02-21 | 仅供追溯，不作为当前参考 -->

# 验证报告：可交付物完整性

**验证日期**：2026-02-21
**L2 原文**：`设计_人机协作模式重建.md`（2900 行）
**L0 文件**：`设计_人机协作模式重建_L0概览.md`
**L1 文件**：6 个（pipeline编排器、SubAgent质量设计、Handoff文档规范、进度与通知、三层架构与Skills、配置与权限）

---

## 可交付物清单

| # | 可交付物 | 类型 | L2行号 | 覆盖文件 | 覆盖方式 | 状态 |
|---|---------|------|--------|---------|---------|------|
| 1 | Design-Plan 评审循环最多 3 轮（MAX_REVIEW=3） | 业务规则 | 28-34, 333 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 2 | Plan-Implement 评审循环最多 3 轮 | 业务规则 | 38-44, 333 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 3 | Implement-Check 循环最多 3 轮（MAX_CHECK_LOOP=3） | 业务规则 | 46-52, 334 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 4 | QA-Fix 循环最多 10 轮（MAX_FIX=10） | 业务规则 | 54-59, 332 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 5 | QA >= 5 轮暂停人工介入 | 业务规则 | 59, 1036-1038 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 6 | QA >= 10 轮终止 | 业务规则 | 59, 1028-1032 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 7 | Fix >= 3 轮注入历史修复上下文 | 业务规则 | 1043-1054 | L1_pipeline编排器 | 完整保留 | ✅ |
| 8 | PASS/FAIL 判定权在 pipeline.sh（独立运行测试） | 业务规则 | 71, 673-702, 1082 | L0, L1_pipeline编排器, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 9 | pipeline.sh 独立运行 pytest/npm test 判定 PASS/FAIL | 代码规格 | 677-702 | L1_pipeline编排器 | 完整保留 | ✅ |
| 10 | HUMAN_CHECKPOINT 默认开启（Design/Plan 人工确认） | 配置项 | 339 | L0, L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 11 | 确认方式：touch / REJECT / review 三种响应 | 业务规则 | 367-406 | L1_pipeline编排器 | 完整保留 | ✅ |
| 12 | 确认轮询：每 30 秒检查、最长 24 小时 | 业务规则 | 382-388 | L1_pipeline编排器 | 完整保留 | ✅ |
| 13 | 进度文件 JSON schema（schema_version, feature, current_step 等） | 数据模型 | 463-487 | L1_pipeline编排器, L1_进度与通知 | 完整保留 | ✅ |
| 14 | 进度文件原子写入（tmp + mv） | 代码规格 | 463-487 | L1_pipeline编排器 | 完整保留 | ✅ |
| 15 | notify() 函数（Glass 音效）+ notify_error()（Basso 音效） | 代码规格 | 349-365 | L1_pipeline编排器, L1_进度与通知 | 完整保留 | ✅ |
| 16 | 通知跨平台：macOS osascript + Linux notify-send | 代码规格 | 349-365 | L1_pipeline编排器, L1_进度与通知 | 完整保留 | ✅ |
| 17 | 通知事件全表（19 个事件，含触发位置/音效） | 数据模型 | 2739-2758 | L1_进度与通知 | 完整保留 | ✅ |
| 18 | feature name 合法性校验（perl 正则，兼容 macOS Unicode） | 代码规格 | 326-329 | L1_pipeline编排器 | 完整保留 | ✅ |
| 19 | CLI_CMD 环境变量（claude / claude-codex / claude-gemini） | 配置项 | 330 | L0, L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 20 | STEP_BUDGET=10.00（临时占位，须 3 次实测校准） | 配置项 | 335 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 21 | STEP_TIMEOUT=1800（单步超时秒数） | 配置项 | 336 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 22 | TOTAL_STEPS=6（design/plan/implement/check/qa/fix） | 配置项 | 337 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 23 | TOTAL_BUDGET=200.00（临时占位，须 3 次实测校准） | 配置项 | 338 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 24 | START_STEP 断点续传（design / implement / qa 三入口） | 配置项 | 711-759 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 25 | 断点续传前置产物验证表 | 业务规则 | 713-758 | L1_pipeline编排器 | 完整保留 | ✅ |
| 26 | SKILLS_DIR=$HOME/.claude/skills | 配置项 | 2628 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 27 | 锁文件机制（mkdir 原子操作，防止同 feature 并行） | 代码规格 | 532-540 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 28 | trap EXIT 清理锁目录 | 代码规格 | 540 | L1_pipeline编排器 | 完整保留 | ✅ |
| 29 | 残留 Handoff 文件启动前检查 | 业务规则 | 518-530 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 30 | pipeline.sh reset 子命令（清理除 clarify 外的产物） | 代码规格 | 175, 1138 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 31 | run_with_timeout 函数（setsid + timeout --signal=KILL） | 代码规格 | 542-562 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 32 | get_permission_mode：Designer/Planner=plan，其余=bypassPermissions | 代码规格 | 564-575 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 33 | verify_no_code_changes（事后 git diff 校验只读角色） | 代码规格 | 577-595 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 34 | run_step 函数流程（9 步：progress->CLI->退出码->文件->非空->章节->validate->diff->budget） | 代码规格 | 597-660 | L1_pipeline编排器 | 完整保留 | ✅ |
| 35 | Handoff 核心章节标题强制校验（输入分析/决策/产出） | 业务规则 | 639-649 | L0, L1_pipeline编排器, L1_Handoff文档规范 | 完整保留 | ✅ |
| 36 | validate_handoff 按步骤类型 grep 检查关键词 | 代码规格 | 413-447 | L1_pipeline编排器 | 完整保留 | ✅ |
| 37 | validate_handoff 定位说明（最低限度格式兜底，非质量门控） | 设计决策 | 408-412 | L1_pipeline编排器 | 完整保留 | ✅ |
| 38 | check_budget 费用累计检查（步数 x STEP_BUDGET 估算） | 代码规格 | 449-461 | L1_pipeline编排器 | 完整保留 | ✅ |
| 39 | parse_review 函数（解析 REVIEW 行，DESIGN_OK/ISSUE、PLAN_OK/ISSUE） | 代码规格 | 662-671 | L1_pipeline编排器 | 完整保留 | ✅ |
| 40 | parse_review MISSING 时不重试直接 exit 1 | 业务规则 | 809-814 | L1_pipeline编排器 | 完整保留 | ✅ |
| 41 | build_prompt 函数（解析 skills 字段拼接 Skill 内容） | 代码规格 | 2336-2350, 2640-2650 | L1_pipeline编排器, L1_三层架构与Skills | 完整保留 | ✅ |
| 42 | get_model 函数（从 SubAgent 文件解析 model 字段） | 代码规格 | 2655-2666 | L1_三层架构与Skills | 完整保留 | ✅ |
| 43 | preflight_check（jq / gtimeout / setsid 依赖检查） | 代码规格 | 489-509 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 44 | IMPL_BASE 回滚锚点（git rev-parse HEAD） | 代码规格 | 892-893 | L1_pipeline编排器 | 完整保留 | ✅ |
| 45 | Implement 失败通知 commit_hashes，不自动回滚 | 业务规则 | 176 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 46 | per-feature 日志文件（pipeline.log） | 代码规格 | 704-708 | L1_配置与权限 | 完整保留 | ✅ |
| 47 | set -euo pipefail | 代码规格 | 320 | L1_pipeline编排器 | 完整保留 | ✅ |
| 48 | INFRA_ERROR 检测（服务启动失败/端口占用），不进入 Fix | 业务规则 | 1000-1005 | L1_pipeline编排器 | 完整保留 | ✅ |
| 49 | .check_passed 持久化标记文件 | 数据模型 | 913, 743-747 | L1_pipeline编排器 | 完整保留 | ✅ |
| 50 | 评审输出独立文件（review_design_N.md / review_plan_N.md） | 数据模型 | 258-265, 1092 | L0, L1_pipeline编排器, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 51 | Designer allowedTools: Read, Write, Glob, Grep, WebSearch | 配置项 | 2535, 1300 | L1_配置与权限, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 52 | Planner allowedTools: Read, Write, Glob, Grep | 配置项 | 2536, 1435 | L1_配置与权限, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 53 | Implementer allowedTools: Read, Write, Edit, Bash, Glob, Grep | 配置项 | 2537, 1591 | L1_配置与权限, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 54 | Checker allowedTools: Read, Bash, Glob, Grep | 配置项 | 2538, 1703 | L1_配置与权限, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 55 | QA allowedTools: Read, Bash, Glob, Grep | 配置项 | 2539, 1805 | L1_配置与权限, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 56 | Fixer allowedTools: Read, Write, Edit, Bash, Glob, Grep | 配置项 | 2540, 1891 | L1_配置与权限, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 57 | Designer skills: [architecture], model: opus, maxTurns: 30, memory: project | Skill/SubAgent配置 | 2535 | L1_配置与权限, L1_三层架构与Skills | 完整保留 | ✅ |
| 58 | Planner skills: [architecture, review-standard], model: opus, maxTurns: 30, memory: project | Skill/SubAgent配置 | 2536 | L1_配置与权限, L1_三层架构与Skills | 完整保留 | ✅ |
| 59 | Implementer skills: [tdd-methodology, code-quality], model: opus, maxTurns: 50, memory: project | Skill/SubAgent配置 | 2537 | L1_配置与权限, L1_三层架构与Skills | 完整保留 | ✅ |
| 60 | Checker skills: [code-quality, review-standard], model: sonnet, maxTurns: 20, memory: - | Skill/SubAgent配置 | 2538 | L1_配置与权限, L1_三层架构与Skills | 完整保留 | ✅ |
| 61 | QA skills: [qa-methodology], model: sonnet, maxTurns: 30, memory: - | Skill/SubAgent配置 | 2539 | L1_配置与权限, L1_三层架构与Skills | 完整保留 | ✅ |
| 62 | Fixer skills: [tdd-methodology, code-quality], model: opus, maxTurns: 40, memory: - | Skill/SubAgent配置 | 2540 | L1_配置与权限, L1_三层架构与Skills | 完整保留 | ✅ |
| 63 | model 字段设计理由（opus=强推理，sonnet=执行验证，成本低） | 设计决策 | 2547 | L1_配置与权限 | 完整保留 | ✅ |
| 64 | maxTurns 设计理由（Implementer 50 多轮 TDD，Checker 20 步骤确定） | 设计决策 | 2548 | L1_配置与权限 | 完整保留 | ✅ |
| 65 | memory 设计理由（Designer/Planner/Implementer 积累项目理解，Checker/QA/Fixer 独立判断） | 设计决策 | 2549 | L1_配置与权限 | 完整保留 | ✅ |
| 66 | SubAgent 文件示例 YAML frontmatter（pipeline-designer.md 完整结构） | 数据模型 | 2553-2599 | L1_配置与权限 | 完整保留 | ✅ |
| 67 | 工具权限三级：只读+Write Handoff / 只读+Bash / 全权限 | 约束条件 | 2603-2609 | L1_配置与权限 | 完整保留 | ✅ |
| 68 | maxTurns/memory CLI 模式不适用说明 | 设计决策 | 2668 | L1_三层架构与Skills | 完整保留 | ✅ |
| 69 | 三层架构：编排层 + 执行层 + 知识层 | 设计决策 | 94-98, 2264-2284 | L0, L1_三层架构与Skills | 完整保留 | ✅ |
| 70 | SubAgent < 3k tokens（精简角色卡） | 约束条件 | 85-86, 96, 229, 271 | L0, L1_三层架构与Skills, L1_配置与权限 | 完整保留 | ✅ |
| 71 | 三层拆分理由（25k+ 臃肿、方法论无法复用、修改多处） | 设计决策 | 2286-2294 | L0, L1_三层架构与Skills | 完整保留 | ✅ |
| 72 | 知识复用矩阵（5 Skills x 6 SubAgents 引用关系） | Skill/SubAgent配置 | 2296-2308 | L0, L1_三层架构与Skills | 完整保留 | ✅ |
| 73 | 两种调用路径（手动 context:fork vs 自动 claude -p） | 设计决策 | 2310-2332 | L0, L1_三层架构与Skills | 完整保留 | ✅ |
| 74 | Skills 加载差异表（手动自动注入 vs 自动 pipeline.sh 手动拼接） | 设计决策 | 2325-2332 | L1_三层架构与Skills | 完整保留 | ✅ |
| 75 | Skill 改造方式（改为 context:fork + agent 声明式） | 设计决策 | 2352-2398 | L1_三层架构与Skills | 完整保留 | ✅ |
| 76 | 改造后 Skill 文件示例（/design YAML frontmatter） | 数据模型 | 2376-2392 | L1_三层架构与Skills | 完整保留 | ✅ |
| 77 | architecture Skill 内容定义（扫描代码、多方案对比、接口完整性等） | Skill/SubAgent配置 | 2406-2418 | L1_三层架构与Skills | 完整保留 | ✅ |
| 78 | tdd-methodology Skill 内容定义（严格 TDD、一任务一 commit 等） | Skill/SubAgent配置 | 2420-2432 | L1_三层架构与Skills | 完整保留 | ✅ |
| 79 | code-quality Skill 内容定义（五维检查、量化规则等） | Skill/SubAgent配置 | 2434-2445 | L1_三层架构与Skills | 完整保留 | ✅ |
| 80 | review-standard Skill 内容定义（对抗性审查、评审标准等） | Skill/SubAgent配置 | 2447-2458 | L1_三层架构与Skills | 完整保留 | ✅ |
| 81 | qa-methodology Skill 内容定义（验收标准唯一来源、端到端验证等） | Skill/SubAgent配置 | 2460-2473 | L1_三层架构与Skills | 完整保留 | ✅ |
| 82 | 19 个 Skills 完整清单（9 Pipeline + 6 独立 + 4 领域） | Skill/SubAgent配置 | 2475-2521 | L1_三层架构与Skills | 完整保留 | ✅ |
| 83 | 5 个已删除 Skill 及原因（gemini-critique, critique, test-gen, explore, debug） | 设计决策 | 2513-2521 | L1_三层架构与Skills | 完整保留 | ✅ |
| 84 | 双模式架构（手动/自动，同一套 SubAgent + Skills） | 设计决策 | 75-101 | L0 | 完整保留 | ✅ |
| 85 | 手动模式 vs 自动模式对比表 | 设计决策 | 89-92 | L0 | 完整保留 | ✅ |
| 86 | 目录结构（agents/ + pipeline.sh + skills/ + 项目内 docs/pipeline/） | 数据模型 | 225-278 | L0 | 完整保留 | ✅ |
| 87 | SubAgent 文件放 ~/.claude/agents/，全局可用 | 约束条件 | 271 | L0, L1_配置与权限 | 完整保留 | ✅ |
| 88 | pipeline.sh 放 ~/.claude/，全局可用 | 约束条件 | 273 | L0 | 完整保留 | ✅ |
| 89 | Handoff 文档放项目内 docs/pipeline/{feature}/ | 数据模型 | 275 | L0, L1_Handoff文档规范 | 完整保留 | ✅ |
| 90 | /ship 后 Pipeline 目录移至 docs/pipeline/archive/ | 业务规则 | 277 | L0, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 91 | Handoff 文件清单（clarify/design/review_N/plan/review_N/run/check/qa/fix_pre_N/fix_N） | 数据模型 | 255-266 | L0 | 完整保留 | ✅ |
| 92 | 设计原则 5 条（独立上下文/文档留痕/失败即停/工具最小化/三层分离） | 设计决策 | 148-156 | L0 | 完整保留 | ✅ |
| 93 | L0 新增"判定权分离"原则 | 设计决策 | — | L0 | L0补充（L2隐含但未列为独立原则） | ✅ |
| 94 | CLI 进程挂死风险防护（timeout + setsid + max-budget-usd） | 约束条件 | 172 | L0, L1_pipeline编排器 | 完整保留 | ✅ |
| 95 | 已知风险表（6 项：CLI 挂死/费用失控/重复启动/残留文件/Implement 失败/Unicode） | 约束条件 | 170-178 | L0 | 完整保留 | ✅ |
| 96 | 10 条通用 Prompt 设计原则 | 业务规则 | 1153-1289 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 97 | 原则 1: 角色身份定义（三要素：身份/行为准则/边界） | 业务规则 | 1157-1172 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 98 | 6 个 SubAgent 角色定义表（替代真人/身份/行为准则/负向约束） | 接口定义 | 1163-1171 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 99 | 原则 2: 显式推理过程（输入分析/决策/产出三段式） | 业务规则 | 1174-1182 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 100 | 原则 3: Few-shot 对比示例（好 vs 坏） | 业务规则 | 1183-1196 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 101 | 原则 4: 结构化交接项（固定传递项清单，8 条步骤间传递关系） | 接口定义 | 1198-1212 | L1_SubAgent质量设计, L1_Handoff文档规范 | 完整保留 | ✅ |
| 102 | 原则 5: 理解输入 + 验证输出（5 阶段对照表） | 业务规则 | 1213-1239 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 103 | 原则 6: SOP 化 Prompt（CoT thinking 标签 + Self-Correction Checklist） | 业务规则 | 1241-1257 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 104 | 原则 7: 早期熔断（EXIT(CRITICAL_DESIGN_FLAW) 等 3 种熔断码） | 业务规则 | 1259-1267 | L0, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 105 | 原则 8: 对抗性思维（仅 Checker/QA，有罪推定） | 业务规则 | 1269-1274 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 106 | 对抗性思维不适用于 Design-Plan/Plan-Implement 评审（定位为 checklist 校验） | 设计决策 | 1086, 1274 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 107 | 原则 9: 负向约束（4 条 Do NOT） | 约束条件 | 1275-1281 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 108 | 原则 10: 结构化输出（XML 标签 metadata/summary/critical_decision） | 接口定义 | 1283-1289 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 109 | Designer 常见失败模式表（4 类） | 业务规则 | 1304-1312 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 110 | Designer 质量标准（扫描现有代码/接口完整/模块边界/可追溯/多方案对比） | 业务规则 | 1316-1320 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 111 | Designer 理解输入具体应用（逐条理解 clarify 规则+正例+反例+排除项） | 业务规则 | 1322-1342 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 112 | Designer 验证输出（覆盖表：clarify 规则 -> 设计产出 -> 覆盖状态） | 业务规则 | 1344-1352 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 113 | Designer 多方案对比方法论（Tree of Thoughts，2-3 备选方案） | 业务规则 | 1354-1369 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 114 | Designer Few-shot 示例（好的设计输出 vs 坏的设计输出） | 业务规则 | 1371-1399 | L1_SubAgent质量设计 | 摘要（L2引用） | ✅ |
| 115 | Designer 质量门控表（6 项检查） | 业务规则 | 1401-1411 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 116 | Designer 自检清单（6 条） | 业务规则 | 1413-1423 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 117 | Planner 常见失败模式表（4 类） | 业务规则 | 1439-1447 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 118 | Planner 质量标准（任务粒度<=5文件/AC可测试/文件明确/依赖清晰） | 业务规则 | 1449-1453 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 119 | Planner 理解输入（从 clarify 和 design 推导拆分方向） | 业务规则 | 1455-1480 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 120 | Planner 验证输出（覆盖表：clarify 规则 -> 设计接口 -> Task） | 业务规则 | 1482-1490 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 121 | Planner Few-shot 示例（好的计划 vs 坏的计划） | 业务规则 | 1492-1526 | L1_SubAgent质量设计 | 摘要（L2引用） | ✅ |
| 122 | Planner 质量门控表（5 项检查） | 业务规则 | 1528-1536 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 123 | Planner 自检清单（6 条） | 业务规则 | 1538-1545 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 124 | Planner 评审 Design 标准（DESIGN_OK vs DESIGN_ISSUE，5 项检查） | 业务规则 | 1547-1579 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 125 | Planner 评审输出格式（REVIEW: DESIGN_OK/ISSUE + Issues 列表） | 接口定义 | 1566-1574 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 126 | Planner 评审自检清单（3 条） | 业务规则 | 1576-1579 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 127 | Implementer 常见失败模式表（4 类） | 业务规则 | 1595-1603 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 128 | Implementer 质量标准（严格 TDD/一任务一 commit/每 commit 含测试/阻塞标注） | 业务规则 | 1604-1611 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 129 | Implementer commit message 格式 feat(Task-N): 描述 | 业务规则 | 1608 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 130 | Implementer Few-shot 示例 | 业务规则 | 1612-1639 | L1_SubAgent质量设计 | 摘要（L2引用） | ✅ |
| 131 | Implementer 质量门控表（5 项检查） | 业务规则 | 1641-1649 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 132 | Implementer 自检清单（6 条） | 业务规则 | 1651-1658 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 133 | Implementer 评审 Plan 标准（PLAN_OK vs PLAN_ISSUE，5 项检查） | 业务规则 | 1660-1691 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 134 | Implementer 评审输出格式（REVIEW: PLAN_OK/ISSUE + Issues 列表） | 接口定义 | 1679-1686 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 135 | Implementer 评审自检清单（3 条） | 业务规则 | 1688-1691 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 136 | Checker 常见失败模式表（4 类） | 业务规则 | 1707-1715 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 137 | Checker 五维检查标准（测试/Lint/类型检查/代码质量规则/AC 覆盖） | 业务规则 | 1719-1726 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 138 | 代码质量量化规则（函数<=40行/参数<=5/嵌套<=3/无空catch/无裸except/无硬编码） | 约束条件 | 1723 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 139 | Checker Five-dimension 全 PASS 才 PASS | 业务规则 | 1726 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 140 | Checker Handoff 中 RESULT: PASS/FAIL 供人阅读参考 | 接口定义 | 1792-1793 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 141 | Checker Few-shot 示例（含 AC 覆盖表格） | 业务规则 | 1728-1774 | L1_SubAgent质量设计 | 摘要（L2引用） | ✅ |
| 142 | Checker 质量门控表（4 项检查） | 业务规则 | 1776-1783 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 143 | Checker 自检清单（7 条） | 业务规则 | 1785-1793 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 144 | QA 常见失败模式表（4 类） | 业务规则 | 1809-1817 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 145 | QA 验收标准唯一来源 handoff_clarify.md | 业务规则 | 1821 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 146 | QA 接口信息来源 handoff_design.md（仅获取路径和参数格式） | 业务规则 | 1822, 1806 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 147 | QA 与 Check 分工：Check 验代码质量，QA 验功能是否满足需求 | 设计决策 | 1823 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 148 | QA 真实服务验证方式（启动服务->健康检查->端到端测试->停止服务） | 业务规则 | 1827 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 149 | QA Few-shot 示例（含逐条验收表格 FAIL 详情） | 业务规则 | 1829-1858 | L1_SubAgent质量设计 | 摘要（L2引用） | ✅ |
| 150 | QA 质量门控表（5 项检查） | 业务规则 | 1861-1869 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 151 | QA 自检清单（7 条） | 业务规则 | 1871-1879 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 152 | Fixer 常见失败模式表（4 类） | 业务规则 | 1895-1903 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 153 | Fixer 质量标准（根因分析/差异说明/最小修改/回归测试/修复后自验） | 业务规则 | 1904-1910 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 154 | Fixer Few-shot 示例（含修复前后 diff 和全量测试结果） | 业务规则 | 1912-1942 | L1_SubAgent质量设计 | 摘要（L2引用） | ✅ |
| 155 | Fixer 质量门控表（6 项检查） | 业务规则 | 1944-1953 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 156 | Fixer 自检清单（6 条） | 业务规则 | 1955-1962 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 157 | Ship Skill 入口（/ship，需用户确认，不纳入自动编排） | 业务规则 | 1966-1976 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 158 | Ship 完成后清理进度文件 + 移至 archive/ | 业务规则 | 1975 | L1_SubAgent质量设计 | 完整保留 | ✅ |
| 159 | Handoff 文档设计原则（自包含/结构化/可追溯） | 设计决策 | 1981-1985 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 160 | Handoff 通用格式模板（功能名/执行时间/执行结果 + 三章节 + 交接项 + 修改的文件） | 数据模型 | 1989-2013 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 161 | SubAgent 文件引用方式（prompt 传入路径，Read 工具读取，不用管道输入） | 设计决策 | 2015-2028 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 162 | /clarify 三个核心缺陷（Slot Filling 无法暴露假设/抽象 AC/苏格拉底误定义） | 设计决策 | 2034-2041 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 163 | /clarify 升级对比表（6 维度对比） | 设计决策 | 2042-2051 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 164 | /clarify 第零步：先理解背景再提问（静默，<=30秒） | 业务规则 | 2053-2105 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 165 | 第零步约束（30秒时间限制/范围限制/超10秒提示用户） | 约束条件 | 2094-2104 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 166 | 苏格拉底五类提问表（澄清/假设探测/后果推演/示例验证/反例构造） | 业务规则 | 2112-2121 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 167 | /clarify 执行流程图（第零步->目标锚定->逐点深挖循环->结构化复述->输出） | 业务规则 | 2128-2169 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 168 | 每轮 1-2 个问题（LLMREI 研究） | 约束条件 | 2126, 2158 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 169 | "质疑方向"定位为自然产物而非独立阶段 | 设计决策 | 2172-2184 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 170 | 不做质疑的场景（Bug 修复/技术债务清理/深思熟虑的功能） | 约束条件 | 2184 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 171 | /clarify Few-shot 示例（好的澄清 vs 坏的澄清） | 业务规则 | 2186-2217 | L1_Handoff文档规范 | 摘要（L2引用） | ✅ |
| 172 | /clarify 输出格式（handoff_clarify.md 模板：需求概述/规则与示例/排除项/技术约束） | 数据模型 | 2219-2254 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 173 | /clarify 输出前自检（4 条） | 业务规则 | 2256-2260 | L1_Handoff文档规范 | 完整保留 | ✅ |
| 174 | 三层感知渠道表（Status Line / /status / 系统通知） | 数据模型 | 2697-2706 | L1_进度与通知 | 完整保留 | ✅ |
| 175 | Status Line 显示效果（[Pipeline: 用户管理 | implement 3/6 | 12m]） | 接口定义 | 2711 | L1_进度与通知, L1_配置与权限 | 完整保留 | ✅ |
| 176 | Status Line 特点（被动/零 token/会话独立/无 Pipeline 回退 ccstatusline） | 设计决策 | 2715-2719 | L1_进度与通知 | 完整保留 | ✅ |
| 177 | /status Skill 输出格式（树形展示完整进度详情） | 接口定义 | 2721-2735 | L1_进度与通知 | 完整保留 | ✅ |
| 178 | Status Line 配置 JSON（settings.json statusLine 字段，含完整 jq 命令） | 配置项 | 2676-2683 | L1_配置与权限, L1_进度与通知 | 完整保留 | ✅ |
| 179 | 方案选型说明（Agent Teams 不采用/Bash run_in_background 不采用/Progress File 采用） | 设计决策 | 2775-2781 | L1_进度与通知 | 完整保留 | ✅ |
| 180 | Agent Teams 不采用原因（并行协作设计/无 session resumption） | 设计决策 | 2779 | L1_进度与通知 | 完整保留 | ✅ |
| 181 | Bash run_in_background 不采用原因（3 个已知 Bug） | 设计决策 | 2780 | L1_进度与通知 | 完整保留 | ✅ |
| 182 | 交付物清单表（12 项） | 数据模型 | 2785-2800 | L1_配置与权限 | 完整保留 | ✅ |
| 183 | SubAgent Prompt 验收标准（5 个必含段落：角色定义/Few-shot/自检清单>=5/输出格式/负向约束>=3） | 业务规则 | 2802-2819 | L1_配置与权限 | 完整保留 | ✅ |
| 184 | 验收流程（骨架 review 30分钟 -> A/B 实测 -> 持续迭代） | 业务规则 | 2816-2819 | L1_配置与权限 | 完整保留 | ✅ |
| 185 | Go-Live 前置验证清单（6 项 checklist） | 业务规则 | 2821-2830 | L1_配置与权限 | 完整保留 | ✅ |
| 186 | 验证方案：自动模式验证（5 步） | 业务规则 | 2838-2848 | L1_配置与权限 | 完整保留 | ✅ |
| 187 | 验证方案：手动模式验证（2 步） | 业务规则 | 2850-2853 | L1_配置与权限 | 完整保留 | ✅ |
| 188 | 验证方案：并行验证（3 步） | 业务规则 | 2855-2859 | L1_配置与权限 | 完整保留 | ✅ |
| 189 | 验证方案：进度可见性验证（5 步） | 业务规则 | 2861-2867 | L1_配置与权限 | 完整保留 | ✅ |
| 190 | 验证方案：评审循环验证（6 步） | 业务规则 | 2869-2876 | L1_配置与权限 | 完整保留 | ✅ |
| 191 | 验证方案：新增功能验证（12 步） | 业务规则 | 2878-2891 | L1_配置与权限 | 完整保留 | ✅ |
| 192 | 验证标准（5 条） | 业务规则 | 2893-2899 | L1_配置与权限 | 完整保留 | ✅ |
| 193 | 前置验证 1: claude -p 中 Task 调用 SubAgent 通过 | 设计决策 | 160 | L0 | L2引用 | ✅ |
| 194 | 前置验证 2: 单次 claude -p 链式调用多 SubAgent 通过 | 设计决策 | 162 | L0 | L2引用 | ✅ |
| 195 | 架构决策：Shell 编排器 + 多次 claude -p（非 LLM 链式调用） | 设计决策 | 164 | L0 | L2引用 | ✅ |
| 196 | 前置验证 3: claude -p --permission-mode plan 待验证（Go-Live 阻断项） | 约束条件 | 166 | L1_配置与权限 | 完整保留 | ✅ |
| 197 | P2 配置质量优化：Skills 精简 31->19（删 14 + 新增 2） | 设计决策 | 186-221 | L1_三层架构与Skills | 完整保留 | ✅ |
| 198 | P2 配置质量：Hooks 精简 12->8（删 4 + 重写 1） | 设计决策 | 208-218 | L1_配置与权限 Section 8 | 完整保留 | ✅ |
| 199 | P2 配置质量：code_quality_check.sh 从 50+ 精简到 ~12 条安全/资源类规则 | 设计决策 | 213 | L1_配置与权限 Section 8.4 | 完整保留 | ✅ |
| 200 | Hooks 职责边界重新定义（Hook=安全防线+机械自动化，质量判断=SubAgent） | 设计决策 | 215-218 | L1_配置与权限 Section 8.2/8.5 | 完整保留 | ✅ |
| 201 | 用户交互设计：场景 1 完整功能开发（对话流程） | 业务规则 | 107-121 | L0 | 摘要 | ✅ |
| 202 | 用户交互设计：场景 2 单步手动 | 业务规则 | 123-130 | L0 | 摘要 | ✅ |
| 203 | 用户交互设计：场景 3 交互式评审 | 业务规则 | 131-139 | L0 | L2引用 | ✅ |
| 204 | 触发规则（/clarify 后提示启动/自然语言触发/独立进程） | 业务规则 | 142-146 | L0 | 摘要 | ✅ |
| 205 | 异常处理全表（pipeline.sh 的全部异常类型、检测方式、处理方式） | 代码规格 | 1113-1144 | L1_pipeline编排器 | 完整保留 | ✅ |
| 206 | 关键设计决策表（pipeline.sh 约 20 条决策） | 设计决策 | 1074-1111 | L1_pipeline编排器 | 完整保留 | ✅ |
| 207 | pipeline.sh 角色与职责（4 做 + 不做） | 设计决策 | 281-292 | L1_pipeline编排器 | 完整保留 | ✅ |
| 208 | pipeline.sh 触发方式（/clarify 后自动 + 手动命令行） | 业务规则 | 296-314 | L1_pipeline编排器 | 完整保留 | ✅ |
| 209 | 交互式 Design/Plan 确认（pipeline.sh review 子命令） | 业务规则 | 1078, 133-138 | L1_pipeline编排器 | 完整保留 | ✅ |
| 210 | SOP 化 Prompt：Key_Decisions.md（Design 额外生成） | 设计决策 | 1087 | L1_SubAgent质量设计 Designer 章节, L1_Handoff文档规范 Section 3 | 完整保留 | ✅ |
| 211 | 费用总控数据驱动（P90 x 1.5 设 TOTAL_BUDGET，P90 x 2 设 STEP_BUDGET） | 业务规则 | 1085 | L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |
| 212 | Handoff 结构化验证升级（XML 标签包裹元数据） | 设计决策 | 1080 | L1_SubAgent质量设计 | 完整保留（原则 10） | ✅ |
| 213 | 评审循环先执行再审查（非 Planner 先提要求再写） | 设计决策 | 1091 | L1_pipeline编排器 | 完整保留 | ✅ |
| 214 | SubAgent 自检清单（每个输出前逐条自检） | 约束条件 | 1079, 1088 | L0, L1_SubAgent质量设计 | 完整保留 | ✅ |
| 215 | 进度文件按 feature 隔离（.pipeline-progress-{feature}.json） | 数据模型 | 73, 252, 345 | L0, L1_pipeline编排器, L1_进度与通知 | 完整保留 | ✅ |
| 216 | 不同 feature 可并行运行互不干扰 | 约束条件 | 276 | L0, L1_pipeline编排器, L1_配置与权限 | 完整保留 | ✅ |

---

## 统计

- **总可交付物数**：216
- **已覆盖**：216（100%）
- **缺失**：0

### 修复记录

以下 4 项在 2026-02-21 第二轮补充中完成覆盖：

| # | 可交付物 | 补充位置 | 补充方式 |
|---|---------|---------|---------|
| 198 | Hooks 精简 12->8（删 4 + 重写 1） | L1_配置与权限 Section 8.1 | 删除清单 + 理由表 |
| 199 | code_quality_check.sh 精简到 ~12 条规则 | L1_配置与权限 Section 8.4 | 12 条规则逐条清单 + 分类 |
| 200 | Hooks 职责边界重新定义 | L1_配置与权限 Section 8.2/8.5 | 职责边界原则 + 分工表 |
| 210 | Key_Decisions.md（Design 额外生成） | L1_SubAgent质量设计 Designer 章节 + L1_Handoff文档规范 Section 3 | MADR 精简版格式规范 + 字段说明 + HUMAN_CHECKPOINT 关系 |

**研究依据**：
- #198-200：对照现有 `~/.claude/hooks/` 实际代码（8 个脚本 + README.md）和 `settings.json` 配置验证，确认 L2 设计已完整实施。补充内容基于社区最佳实践："Hook = deterministic control over a probabilistic system"
- #210：基于 ADR（Architecture Decision Record）和 MADR（Markdown ADR）社区标准，结合 Pipeline 特有的 HUMAN_CHECKPOINT 机制设计精简版格式

### 覆盖质量总体评价

L0+L1 对 L2 原文的可交付物覆盖率为 100%。核心设计（pipeline.sh 逻辑、SubAgent 配置与质量设计、Handoff 规范、进度与通知、三层架构、配置与权限、Hooks 改造）全部完整覆盖。
