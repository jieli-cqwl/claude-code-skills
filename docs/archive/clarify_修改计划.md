# Skills 优化修改计划

**计划日期**：2026-01-30
**需求来源**：用户发现评审流程与规范冲突
**目标**：增加"简单、合适、演化"原则 + 修复评审流程冲突

---

## 需求确认

✅ **用户已确认**：
1. 同意分析结果
2. 同意改进方案
3. 需要修改，但要检查关联文件

---

## 影响范围分析

### 1. 直接修改文件（核心）

| 文件 | 修改内容 | 优先级 |
|------|---------|--------|
| `架构设计_design/SKILL.md` | 增加"简单、合适、演化"设计哲学 | P0 |
| `方案评审_critique/SKILL.md` | 增加阶段感知 + 修改业务语言翻译表 + 增加过度设计检查 | P0 |

### 2. 间接影响文件（引用关系）

| 文件 | 影响类型 | 是否需要修改 |
|------|---------|-------------|
| `需求澄清_clarify/SKILL.md` | 引用 `/critique` | ❌ 不需要（只是引用） |
| `写计划_plan/SKILL.md` | 引用 `/critique` | ❌ 不需要（只是引用） |
| `自动开发_auto-dev/SKILL.md` | 引用 `/critique` | ❌ 不需要（只是引用） |
| `开发检查_check/SKILL.md` | 独立的检查流程 | ❌ 不需要（不冲突） |
| `专家协作_experts/workflows/architecture-review.md` | 独立的评审工作流 | ❌ 不需要（不冲突） |

### 3. 文档类文件（历史记录）

| 文件 | 类型 | 处理方式 |
|------|------|---------|
| `docs/需求文档/clarify_评审冲突分析.md` | 分析文档 | ✅ 保留（作为决策依据） |
| `docs/需求文档/clarify_skills优化评估.md` | 评估文档 | ✅ 保留（作为决策依据） |
| `docs/需求文档/PRD_scan_skill评审.md` | 历史文档 | ❌ 不修改 |
| `docs/设计文档/调研_scan_skill评审.md` | 历史文档 | ❌ 不修改 |

---

## 修改计划

### 修改 1：架构设计增加"简单、合适、演化"原则

**文件**：`架构设计_design/SKILL.md`

**修改位置**：在"核心原则"章节最前面增加"设计哲学"

**修改内容**：

```markdown
## 设计哲学：简单、合适、演化

> 架构设计的核心是"恰到好处"，而非"越复杂越好"或"越简单越好"

### 三大原则

| 原则 | 含义 | 应用 |
|------|------|------|
| **简单** | 不过度设计，避免"万一将来需要"的预设 | 只有多个实现时才抽象接口；不为未来需求预设功能 |
| **合适** | 该复杂时复杂（业务本身复杂），该简单时简单 | 复杂度应匹配业务复杂度，不多不少 |
| **演化** | 根据实际需求演化，重复 3 次再抽象 | 为演化留空间（接口、配置、扩展字段），但不提前实现 |

### 与其他原则的关系

以下 5 个原则在应用时，都应遵循"简单、合适、演化"的哲学：

- **单一职责** + 简单原则 → 不要为了"单一职责"过度拆分模块
- **接口先行** + 合适原则 → 只有多个实现时才抽象接口
- **数据驱动** + 演化原则 → 数据模型预留扩展字段（如 JSON 字段）
- **最小依赖** + 演化原则 → 依赖关系根据实际需求演化，不预设
- **可测试性** + 简单原则 → 不为了测试而过度抽象

---

## 核心原则（技术实现层面）

[保留原有的 5 个原则...]
```

**修改行号**：约在 86 行之前插入

---

### 修改 2：评审流程增加阶段感知

**文件**：`方案评审_critique/SKILL.md`

#### 2.1 增加 Phase 0：识别阶段

**修改位置**：在"执行流程"章节，Phase 1 之前增加 Phase 0

**修改内容**：

```markdown
### Phase 0: 识别阶段（新增）

> 根据评审对象判断当前处于哪个阶段，决定评审策略

**判断依据**：

| 评审对象 | 判断为 | 评审策略 |
|---------|--------|---------|
| `/clarify` 输出（需求文档） | 需求阶段 | 聚焦需求完整性、一致性 |
| `/explore` 输出（方案选型） | 方案阶段 | 聚焦技术可行性、风险 |
| `/design` 输出（架构设计） | **开发阶段** | 聚焦功能正确性、代码质量、安全性 |
| `/plan` 输出（实施计划） | **开发阶段** | 聚焦计划可行性、任务拆分 |
| `/perf` 或性能优化需求 | **优化阶段** | 聚焦性能、缓存、并发、限流 |
| 重构需求 | 稳定阶段 | 聚焦可维护性、技术债务 |

**评审维度调整**：

| 阶段 | 评审维度 |
|------|---------|
| **开发阶段** | 完整性、一致性、可行性、遗漏分析、安全性、可维护性、用户体验、**过度设计检查** |
| **优化阶段** | 所有维度 + 性能影响、缓存策略、并发控制、限流策略 |

**输出**：
- 当前阶段：[开发阶段 / 优化阶段 / 其他]
- 评审策略：[聚焦哪些维度]
```

**修改行号**：约在 100 行左右插入

---

#### 2.2 修改业务语言翻译表

**修改位置**：`方案评审_critique/SKILL.md` 约 270-280 行

**修改前**：
```markdown
| 没有并发控制 | 多人同时操作时可能互相覆盖，数据丢失 |
| 没有缓存 | 每次操作都很慢，用户体验差 |
| 接口没有限流 | 被恶意调用时系统会崩溃 |
```

**修改后**：
```markdown
| 没有并发控制 | [看场景] 多人同时操作时可能互相覆盖，数据丢失 |
| 没有缓存 | [优化阶段] 每次操作都很慢，用户体验差 |
| 接口没有限流 | [优化阶段] 被恶意调用时系统会崩溃 |
```

**增加说明**：
```markdown
**阶段标注说明**：
- `[优化阶段]`：只在性能优化阶段检查，开发阶段不检查（避免过度设计）
- `[看场景]`：根据业务场景判断是否需要（如多人协作场景才需要并发控制）
- 无标注：所有阶段都检查（基本质量要求）
```

---

#### 2.3 增加"过度设计"检查维度

**修改位置**：在"评审维度"章节增加第 11 个维度

**修改内容**：

```markdown
### 11. 过度设计检查（开发阶段）

> 遵循"简单、合适、演化"原则，检查是否过度设计

**检查内容**：

| 检查项 | 说明 | 业务语言 |
|--------|------|---------|
| 不必要的抽象 | 只有一个实现却定义了接口 | 代码过度抽象，增加理解成本 |
| 不必要的设计模式 | 使用了单例、工厂、策略等模式，但业务不需要 | 代码复杂度高，维护成本大 |
| 为未来预设功能 | 实现了当前不需要的功能（"万一将来需要"） | 代码冗余，增加维护负担 |
| 过早优化 | 开发阶段就加了缓存、限流等优化 | 增加调试难度，违反项目规范 |
| 模块拆分过细 | 模块过多导致理解困难 | 代码分散，难以理解全貌 |

**判断标准**：

✅ **合理的设计**：
- 接口有 2+ 个实现
- 设计模式解决了实际问题
- 功能是当前需求必需的
- 模块拆分清晰且必要

❌ **过度设计**：
- 接口只有 1 个实现（"为了扩展性"）
- 设计模式增加了复杂度但没有收益
- 功能是"将来可能需要"
- 模块拆分导致理解困难

**与"简单、合适、演化"的关系**：
- **简单原则**：检查是否有不必要的抽象和设计模式
- **合适原则**：检查复杂度是否匹配业务复杂度
- **演化原则**：检查是否为演化留了空间（接口设计、模块边界），但没有提前实现
```

---

#### 2.4 修改并行策略

**修改位置**：Phase 3 并行评审部分

**修改前**：10 个维度 → 5 个评审组

**修改后**：11 个维度 → 6 个评审组（增加"过度设计检查"）

**新的评审组划分**：

| 评审组 | 维度 | Agent 职责 |
|--------|------|-----------|
| 1. 需求覆盖 | 完整性 + 遗漏分析 | 检查功能是否完整 |
| 2. 方案一致性 | 一致性 + 可行性 | 检查方案是否可落地 |
| 3. 风险安全 | 风险 + 安全性 | 检查潜在风险和安全漏洞 |
| 4. 工程质量 | 技术债务 + 可维护性 | 检查代码质量 |
| 5. 性能体验 | 性能影响 + 用户体验 | 检查性能和体验 |
| 6. 设计合理性 | **过度设计检查**（新增） | 检查是否过度设计 |

**注意**：
- 开发阶段：启动 5 个 Agent（1-4 + 6，不启动 5）
- 优化阶段：启动 6 个 Agent（全部）

---

### 修改 3：更新评审报告模板

**修改位置**：Phase 4 汇总输出部分

**增加内容**：

```markdown
### 总体评价（6 评审组）

| 评审组 | 评分 | 说明 |
|--------|------|------|
| 需求覆盖 | ✅ 高 / ⚠️ 中 / ❌ 低 | [一句话说明] |
| 方案一致性 | ✅ 高 / ⚠️ 中 / ❌ 低 | [一句话说明] |
| 风险安全 | ✅ 低 / ⚠️ 中 / ❌ 高 | [一句话说明] |
| 工程质量 | ✅ 高 / ⚠️ 中 / ❌ 低 | [一句话说明] |
| 性能体验 | ✅ 高 / ⚠️ 中 / ❌ 低 | [仅优化阶段] |
| 设计合理性 | ✅ 简单合适 / ⚠️ 略复杂 / ❌ 过度设计 | [一句话说明] |

**当前阶段**：[开发阶段 / 优化阶段]
```

---

## 修改顺序

1. **先修改 `架构设计_design/SKILL.md`**（增加设计哲学）
2. **再修改 `方案评审_critique/SKILL.md`**（增加阶段感知 + 过度设计检查）
3. **验证修改**（检查是否有遗漏）

---

## 验证清单

修改完成后，验证以下内容：

- [ ] `design/SKILL.md` 增加了"简单、合适、演化"设计哲学
- [ ] `critique/SKILL.md` 增加了 Phase 0（识别阶段）
- [ ] `critique/SKILL.md` 修改了业务语言翻译表（标注阶段）
- [ ] `critique/SKILL.md` 增加了"过度设计检查"维度
- [ ] `critique/SKILL.md` 更新了并行策略（6 个评审组）
- [ ] `critique/SKILL.md` 更新了评审报告模板
- [ ] 所有修改与"简单、合适、演化"原则一致
- [ ] 所有修改与项目规范（性能效率.md）一致

---

## 风险评估

| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| 修改后其他 skill 引用失效 | 低 | 其他 skill 只是引用 `/critique`，不依赖内部实现 |
| 评审组数量变化影响性能 | 低 | 6 个 Agent 相比 5 个，增加不大 |
| 阶段判断错误 | 中 | 在 Phase 0 明确判断逻辑，并输出判断结果 |

---

## 下一步

请确认修改计划：

1. 是否同意修改顺序？
2. 是否同意修改内容？
3. 是否需要调整某些细节？

确认后我将开始执行修改。
