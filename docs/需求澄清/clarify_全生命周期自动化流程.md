## 需求澄清结果

**需求名称**：Claude Code 全生命周期自动化流程建设
**澄清日期**：2026-01-31
**状态**：已确认
**文档路径**：docs/需求澄清/clarify_全生命周期自动化流程.md

---

### 0. 项目上下文

**功能类型**：[Skills开发]

> ⚠️ **重要**：此标记决定是否应用全栈开发规范
> - 全栈：需要前后端同步完成
> - 纯后端/纯前端/CLI/Skills：不强制要求全栈

**背景**：
- 老板 KPI：建立 Claude Code 的全生命周期自动化流程
- 参考来源：朋友分享的已验证方案（全生命周期协作链路 + 专家角色 + 评分体系 + 发布门禁）
- 团队规模：5-10 人中团队
- 交付要求：实际跑出来结果（不是演示文档）

**现有体系**：
- 30+ Skills 覆盖需求→设计→开发→测试→交付 5 阶段
- 15 份 reference 规范（代码质量、全栈开发、性能效率等）
- 铁律体系（禁止降级/硬编码/Mock）
- `/auto-dev` 无人值守开发模式

**GAP 分析结论**：
- 已覆盖：核心开发链路（需求→设计→开发→测试→交付）
- 部分覆盖：量化评分、JSON 报告、技能间数据流转标准化
- 完全缺失：发布门禁、回滚决策、灰度发布、监控告警

**关键约束**：
- 项目铁律：禁止降级、禁止硬编码、禁止 Mock
- 交付标准：实际可跑通，不是 Demo
- 落地路径：A 展示级（先整理+跑通，再迭代补齐）

---

### 1. 背景

老板要求建立 Claude Code 全生命周期自动化流程。用户已有完整的 Skills 体系（30+ 个），但缺乏系统性的整理、验证和呈现。朋友分享了一套已验证方案作为参考，需要基于自身现状评估取舍，补齐关键缺失环节，最终交付一套实际可运行的自动化流程。

核心诉求不是"搭建新流程"，而是：
1. 搞清楚已有体系的全貌和价值
2. 补齐关键缺失环节（发布门禁、回滚机制）
3. 用真实案例跑通全流程，证明可用
4. 形成可向老板交付的 KPI 成果

---

### 2. 目标

- **功能目标**：
  - 整理现有 Skills 体系为完整的全生命周期流程图
  - 补齐发布门禁 Skill（`/release-gate`）
  - 用一个真实需求从 `/clarify` 跑到 `/ship`，验证全流程贯通
  - 输出流程覆盖矩阵表和质量门禁清单

- **质量目标**：
  - 全流程可一键跑通（通过 `/auto-dev` 或手动逐步执行）
  - 每个阶段有明确的门控条件和交付物
  - 发布门禁覆盖：安全漏洞 0 高危 + 测试全通过 + 服务可启动

- **交付目标**：
  - 实际跑通的全流程记录（不是 PPT）
  - 可复用的流程体系（其他同事能按流程操作）

---

### 3. 技术方案要点

**涉及模块**：
- `~/.claude/skills/` — 所有 Skills 文件
- `~/.claude/rules/RULES.md` — 核心规范
- `~/.claude/reference/` — 参考规范
- `~/.claude/skills/STANDARD.md` — Skills 总体索引

**交付物拆解**：

| 序号 | 交付物 | 说明 |
|------|--------|------|
| D1 | 流程覆盖矩阵表 | 5 阶段 × 已有 Skill 对照表，标注覆盖状态 |
| D2 | 质量门禁清单 | 每个阶段的门控条件、阻塞行为、修复指引 |
| D3 | 全流程贯通验证 | 选一个真实需求，从 `/clarify` 走到 `/ship`，记录每步输入输出 |
| D4 | GAP 补齐清单 | 已补齐 / 待补齐 / 不需要的项目清单及理由 |

**不做的事情**（基于分析的取舍决策）：

| 不做 | 理由 |
|------|------|
| 100 分制评分体系 | 维护成本极高，通过/不通过更务实 |
| 容量规划模型 | 属于基础设施职责，不应放在开发流程中 |
| 监控告警体系 | 应由专门的监控系统负责，Skill 最多做集成检查 |
| 心理学专家贯穿全流程 | `/product` 覆盖设计阶段足够，全流程贯穿收益不大 |
| 每个 Skill 独立 Bash 脚本 | Claude 本身就是执行引擎，不需要额外脚本 |

---

### 4. 验收标准（Acceptance Criteria）

> ⚠️ **AC 单一来源声明**：此处定义的 AC 是整个开发流程的唯一验收标准。
> `/plan`、`/test-gen`、`/qa` 必须引用此 AC，禁止重新定义。

#### 4.1 AC 表格（Given-When-Then 格式）

##### 正常流程

| AC-ID | Given（前置条件） | When（操作） | Then（预期结果） | 优先级 | 验证方法 |
|-------|------------------|-------------|-----------------|--------|---------|
| AC-1 | 已有 30+ Skills 和 15 份 reference 规范 | 梳理所有 Skill 与 5 个生命周期阶段的对应关系 | 输出流程覆盖矩阵表，标注每个阶段的 Skill 名称、职责、输入输出 | P0 | 人工审查矩阵表完整性 |
| AC-2 | 流程覆盖矩阵表已完成 | 梳理每个阶段的门控条件 | 输出质量门禁清单，每个门禁包含：触发条件、阻塞行为、修复指引 | P0 | 人工审查清单覆盖所有阶段 |
| AC-3 | 矩阵表和门禁清单已完成 | 选择一个真实需求，按全流程执行：clarify → explore → design → plan → run-plan → check → qa → ship | 每个阶段产出预期的文档/代码，全流程走通无阻塞 | P0 | 实际执行验证 |
| AC-4 | 全流程已走通 | 记录每个阶段的输入、输出、耗时、遇到的问题 | 输出全流程贯通验证报告，含每步截图/日志 | P0 | 报告内容完整可追溯 |
| AC-5 | 全流程验证完成 | 对比朋友方案，列出 GAP 清单 | 输出 GAP 补齐清单，每项标注"已补齐/待补齐/不需要"及理由 | P1 | 人工审查理由充分性 |

##### 异常流程

| AC-ID | Given | When | Then | 优先级 | 验证方法 |
|-------|-------|------|------|--------|---------|
| AC-6 | 全流程执行中 | 某个阶段的门控条件不满足（如测试不通过） | 流程阻塞在该阶段，输出明确的失败原因和修复指引，不静默跳过 | P0 | 故意制造一个门控失败场景验证 |
| AC-7 | 全流程执行中 | 某个 Skill 的输入文档不存在 | 该 Skill 拒绝执行，提示"缺少前置文档 [路径]" | P1 | 跳过某个前置步骤直接执行后续 Skill |
| AC-8 | 梳理 Skills 时 | 发现某个 Skill 与其他 Skill 职责重叠或矛盾 | 记录到 GAP 清单中，标注建议处理方式（合并/保留/删除） | P1 | 人工审查 |

##### 边界情况

| AC-ID | Given | When | Then | 优先级 | 验证方法 |
|-------|-------|------|------|--------|---------|
| AC-9 | 选择的真实需求是小型改动（< 3 个文件） | 按全流程执行 | 流程能正确识别为"小改动"，走简化流程（开发→check→ship），不强制走完所有阶段 | P2 | 选一个小需求验证 |
| AC-10 | 流程矩阵中某个阶段有多个 Skill 可选（如开发阶段有 `/run-plan` 和 `/auto-dev`） | 整理矩阵表 | 明确标注每个 Skill 的适用场景和选择条件，不存在"不知道该用哪个"的模糊地带 | P2 | 人工审查选择指引的清晰度 |

#### 4.2 质量验收（可量化指标）

- [ ] 流程覆盖矩阵表覆盖 5 个阶段，每个阶段至少对应 1 个 Skill
- [ ] 质量门禁清单覆盖所有阶段，每个门禁有明确的通过/不通过标准
- [ ] 全流程贯通验证用真实需求完成（不是虚构案例）
- [ ] GAP 清单每项有"已补齐/待补齐/不需要"状态和理由

#### 4.3 规范验收（来自项目规范）

- [ ] 所有文档保存在指定路径
- [ ] 无硬编码配置
- [ ] 不存在"基本上完成"、"应该可以"等模糊表述
- [ ] 交付物之间的引用关系明确（矩阵表引用 Skill 名称，门禁清单引用门控条件）

---

以上理解是否正确？确认后进入方案探索 (`/explore`)
